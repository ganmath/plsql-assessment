DROP TABLE SOURCE_TRADES CASCADE CONSTRAINTS;

DROP TABLE ANALYZED_TRADES CASCADE CONSTRAINTS;

DROP TABLE ERROR_LOGS CASCADE CONSTRAINTS;

CREATE TABLE SOURCE_TRADES (
    TRADE_ID INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    SECURITY_ID INT NOT NULL,
    VOLUME INT NOT NULL,
    PRICE DECIMAL(10, 2) NOT NULL,
    TRADE_DATE DATE NOT NULL
);

CREATE TABLE ANALYZED_TRADES (
    ANALYSIS_ID INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    SOURCE_TRADE_ID INT NOT NULL,
    DAILY_VOLUME INT NOT NULL,
    AVERAGE_PRICE DECIMAL(10, 2) NOT NULL,
    ANALYSIS_DATE DATE NOT NULL,
    CONSTRAINT FK_SOURCE_TRADE FOREIGN KEY (SOURCE_TRADE_ID) REFERENCES SOURCE_TRADES (TRADE_ID)
);

CREATE TABLE error_logs (
    error_id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    error_message VARCHAR2(4000),
    timestamp TIMESTAMP
);
